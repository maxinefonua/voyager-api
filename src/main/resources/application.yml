spring:
  jpa:
    show-sql: false
    hibernate:
      ddl-auto: validate
      format_sql: false
  thymeleaf:
    prefix: classpath:/templates/
    suffix: .html
    mode: HTML
    cache: false
    enabled: true
    check-template: true
    check-template-location: true
  logging:
    level:
      org:
        springframework:
          cache: trace
  datasource:
    url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}
    username: ${POSTGRES_USER:}
    password: ${POSTGRES_PASSWORD:}
    hikari:
      # Connection pool settings
      maximum-pool-size: 10  # Start with a reasonable number
      minimum-idle: 3
      connection-timeout: 30000  # 30 seconds
      idle-timeout: 600000  # 10 minutes
      max-lifetime: 1800000  # 30 minutes
      pool-name: MainPool

      # PostgreSQL specific optimizations
      connection-init-sql: "SELECT 1"
      validation-timeout: 5000
      leak-detection-threshold: 60000  # Detect leaks after 60 second
  admin:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}
      username: ${POSTGRES_ADMIN_USER:}
      password: ${POSTGRES_ADMIN_PASSWORD:}
      hikari:
        maximum-pool-size: 5  # Smaller pool for admin
        pool-name: AdminPool
  tests:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}
      username: ${POSTGRES_TESTS_USER:}
      password: ${POSTGRES_TESTS_PASSWORD:}
      hikari:
        maximum-pool-size: 5  # Smaller pool for tests
        pool-name: TestsPool

server:
  port: ${SERVER_PORT:8080}
  error:
    include-message: always

geonames:
  protocol: https
  host: secure.geonames.org
  sourceName: GeoNames
  sourceLink: https://www.geonames.org/
  searchPath: /searchJSON
  getPath: /getJSON
  maxRows: 10
  username: ${GEONAMES_API_USERNAME}
  isNameRequired: true
  featureClass: P
  featureClassAdmin: A

cors:
  allowed-origin-patterns:
    - "http://localhost:*"
    - "https://localhost:*"

app:
  version: @project.version@
  name: @project.name@
  description: @project.description@
  artifactId: @project.artifactId@
  groupId: @project.groupId@

public:
  daily:
    limit: ${PUBLIC_DAILY_LIMIT:1000}

auth:
  adminApiKey: ${ADMIN_API_KEY:}
  testsApiKey: ${TESTS_API_KEY:}
  userApiKey: ${VOYAGER_API_KEY:}

# Development profile
---
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_dev
  admin:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_dev
  tests:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_dev
name: dev-YAML
runtime:
  environment: dev
enabled: true

# Staging profile
---
spring:
  config:
    activate:
      on-profile: stage
  datasource:
    url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_stage
  admin:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_stage
  tests:
    datasource:
      url: jdbc:postgresql://${POSTGRES_HOST:}:${POSTGRES_PORT:}/${POSTGRES_DB:}_stage
name: stage-YAML
runtime:
  environment: stage
enabled: true
server:
  port: ${SERVER_PORT:8081}

# Production profile
---
spring:
  config:
    activate:
      on-profile: prod
  thymeleaf:
    cache: true
  jpa:
    hibernate:
      ddl-auto: validate
  logging:
    level:
      org:
        springframework:
          cache: INFO
name: prod-YAML
runtime:
  environment: prod
enabled: true